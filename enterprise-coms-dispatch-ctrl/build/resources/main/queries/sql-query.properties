
#GET.TRX.HDR.ID=SELECT TRX_HDR_ID AS TRXHDRID, '' AS QUEUENAME FROM EEM2.EEM_TRX_HDR WHERE trx_stat_cd in (SELECT trx_stat_cd FROM eem2.trx_evnt_stat_cd WHERE trx_stat_abb in ('READY','RPROC')) AND TRX_ID IN (SELECT TRX_ID AS TRXID FROM EEM2.EEM_TRX_CFG WHERE DSP_CNTLR_NM = (SELECT CC.CNTLR_NM FROM EEM2.EEM_CNTLR_CFG CC INNER JOIN EEM2.EEM_CNTLR_SRVR_CONFIG CSC ON CSC.CNTLR_NM = CC.CNTLR_NM WHERE CSC.ACTV_SW = 'Y' AND CC.ACTV_SW = 'Y' AND CSC.SRVR_NM =:srcSystem AND CC.CNTLR_TYP_CD = 'DSPTR')) AND ((  TO_DATE (TO_CHAR (trx_sch_proc_ts, 'dd/mm/yyyy  hh24:mi:ss'),'dd/mm/yyyy  hh24:mi:ss')- TO_DATE (TO_CHAR (SYSTIMESTAMP, 'dd/mm/yyyy  hh24:mi:ss'),'dd/mm/yyyy  hh24:mi:ss'))* (24 * 60) <= 0 OR trx_sch_proc_ts is null)
#Defect 953
#GET.TRX.HDR.ID=SELECT trx_hdr_id AS trxhdrid,  ''  AS queuename FROM eem2.eem_trx_hdr eth INNER JOIN eem2.trx_evnt_stat_cd tesc ON tesc.trx_stat_cd = eth.trx_stat_cd AND trx_stat_abb  IN ('READY','RPROC')INNER JOIN eem2.eem_trx_cfg etc ON etc.trx_id = eth.trx_id INNER JOIN eem2.eem_cntlr_cfg cc ON cc.cntlr_nm = etc.dsp_cntlr_nm INNER JOIN eem2.eem_cntlr_srvr_config csc ON csc.cntlr_nm = cc.cntlr_nm AND csc.actv_sw = 'Y'AND cc.actv_sw = 'Y'AND csc.srvr_nm  = :srcSystem AND cc.cntlr_typ_cd =  'DSPTR' AND ( ( TO_DATE (TO_CHAR (trx_sch_proc_ts, 'dd/mm/yyyy hh24:mi:ss'), 'dd/mm/yyyy hh24:mi:ss' ) - TO_DATE (TO_CHAR (SYSTIMESTAMP, 'dd/mm/yyyy hh24:mi:ss'), 'dd/mm/yyyy hh24:mi:ss' ) ) * (24 * 60) <= 0 OR trx_sch_proc_ts is null)

GET.TRX.HDR.ID=SELECT eth.trx_hdr_id AS trxhdrid, '' AS queuename, etc.TRX_TRG_JOB_NM AS skippableTrxns, eth.SRC_TRX_TYP_NM AS srcTrxTypNm, eth.LOGIC_KEY_VAL AS logicKeyVal, systimestamp AS batchTs FROM eem2.eem_trx_hdr eth INNER JOIN eem2.eem_trx_cfg etc ON etc.trx_id = eth.trx_id INNER JOIN eem2.eem_cntlr_cfg cc ON cc.cntlr_nm = etc.dsp_cntlr_nm AND cc.cntlr_typ_cd = 'DSPTR' AND cc.actv_sw = 'Y' INNER JOIN eem2.eem_cntlr_srvr_config csc ON csc.cntlr_nm = cc.cntlr_nm AND csc.actv_sw = 'Y' AND csc.srvr_nm = :srcSystem AND( ( eth.trx_sch_proc_ts <= cast(SYSTIMESTAMP as timestamp) ) OR eth.trx_sch_proc_ts IS NULL ) AND eth.trx_stat_cd IN('READY','RPROC')

UPDATE.TRX.HDR=UPDATE EEM2.EEM_TRX_HDR SET TRX_STAT_CD=:status,lst_updt_uid = 'COMS',lst_updt_ts = SYSTIMESTAMP,TRX_STAT_CD_TS=SYSTIMESTAMP WHERE TRX_HDR_ID=:trxHdrId

GET.QUEUE.NAME=SELECT DSP_WRK_Q_NM AS queueName,'' AS trxHdrId FROM EEM2.DSP_WRK_QUEUE WHERE ACTV_SW='Y' AND CNTLR_NM= (SELECT CC.CNTLR_NM FROM EEM2.EEM_CNTLR_CFG CC INNER JOIN EEM2.EEM_CNTLR_SRVR_CONFIG CSC ON CSC.CNTLR_NM = CC.CNTLR_NM WHERE CSC.ACTV_SW='Y' AND CC.ACTV_SW='Y' AND CSC.SRVR_NM =:srcSystem AND CC.CNTLR_TYP_CD='DSPTR')
